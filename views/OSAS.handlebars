<form action="/zoznam_pacientov" method="POST">

  <div class="row_content" id="0">
    <div class="question-group">
      <p>Dotazník vypĺňal: </p>
    </div>
    <div class="radio-group">
      <input type="radio" id="creator-1" name="OSAS_creator" value="Doktor">
      <label for="creator-1">Doktor</label>
      <input type="radio" id="creator-2" name="OSAS_creator" value="Rodič">
      <label for="creator-2">Rodič</label>
      <input type="radio" id="creator-3" name="OSAS_creator" value="Dieťa">
      <label for="creator-3">Dieťa</label>
    </div>
  </div>

  <div class="section">
    <h2>Nos</h2>
  </div>

  <div class="row_content" id="1">
    <div class="question-group">
      <p>1. Derivácia nosovej prepážky:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-1-option-1" name="OSAS_answer_1" value="2">
      <label for="q-1-option-1">ÁNO</label>
      <input type="radio" id="q-1-option-2" name="OSAS_answer_1" value="0">
      <label for="q-1-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="2">
    <div class="question-group">
      <p>2. Dýchanie ústami:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-2-option-1" name="OSAS_answer_2" value="2">
      <label for="q-2-option-1">ÁNO</label>
      <input type="radio" id="q-2-option-2" name="OSAS_answer_2" value="0">
      <label for="q-2-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="3">
    <div class="question-group">
      <p>3. Hypotónia nosovej chrupavky:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-3-option-1" name="OSAS_answer_3" value="2">
      <label for="q-3-option-1">ÁNO</label>
      <input type="radio" id="q-3-option-2" name="OSAS_answer_3" value="0">
      <label for="q-3-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="4">
    <div class="question-group">
      <p>4. Hypotónia musculus orbicularis oris sup. et inf.:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-4-option-1" name="OSAS_answer_4" value="2">
      <label for="q-4-option-1">ÁNO</label>
      <input type="radio" id="q-4-option-2" name="OSAS_answer_4" value="0">
      <label for="q-4-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="5">
    <div class="question-group">
      <p>5. Priechodnosť nosovej dutiny (hodnotenie pomocou fyzikálneho vyšetrenia – pacient sa 3 krát nadýchne a
        vydýchne kým lekár komprimuje najskôr pravú, potom ľavú nosovú dierku a hodnotí obštrukciu obidvoch nosových
        priechodov)</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-5-option-1" name="OSAS_answer_5" value="2">
      <label for="q-5-option-1">ÁNO</label>
      <input type="radio" id="q-5-option-2" name="OSAS_answer_5" value="0">
      <label for="q-5-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="6">
    <div class="question-group">
      <p>6. Chronická obštrukcia nosa (dieťa má upchaný nos, resp. diagnóza chronickej nádchy trvajúcej dlhšie ako 6
        mesiacov)</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-6-option-1" name="OSAS_answer_6" value="2">
      <label for="q-6-option-1">ÁNO</label>
      <input type="radio" id="q-6-option-2" name="OSAS_answer_6" value="0">
      <label for="q-6-option-2">NIE</label>
    </div>
  </div>

  <div class="section">
    <h2>OROPHARYNX</h2>
  </div>

  <div class="row_content" id="7">
    <div class="question-group">
      <p>1. Klinické hodnotenie tonzilárnej hypertrofie:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-7-option-1" name="OSAS_answer_7" value="0">
      <label for="q-7-option-1">I.</label>
      <input type="radio" id="q-7-option-2" name="OSAS_answer_7" value="0">
      <label for="q-7-option-2">II.</label>
      <input type="radio" id="q-7-option-3" name="OSAS_answer_7" value="2">
      <label for="q-7-option-3">III.</label>
      <input type="radio" id="q-7-option-4" name="OSAS_answer_7" value="2">
      <label for="q-7-option-4">IV.</label>
    </div>
  </div>

  <div class="row_content" id="8">
    <div class="question-group">
      <p>2. Klinické hodnotenie pozície podnebia podľa Friedmana:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-8-option-1" name="OSAS_answer_8" value="0">
      <label for="q-8-option-1">I.</label>
      <input type="radio" id="q-8-option-2" name="OSAS_answer_8" value="0">
      <label for="q-8-option-2">II.</label>
      <input type="radio" id="q-8-option-3" name="OSAS_answer_8" value="2">
      <label for="q-8-option-3">III.</label>
      <input type="radio" id="q-8-option-4" name="OSAS_answer_8" value="2">
      <label for="q-8-option-4">IV.</label>
    </div>
  </div>

  <div class="section">
    <h2>DENTOFACIÁLNE ANOMÁLIE</h2>
  </div>

  <div class="row_content" id="9">
    <div class="question-group">
      <p>1. Anomálie polohy čeľustí oproti lebkovej spodine:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-9-option-1" name="OSAS_answer_9" value="0">
      <label for="q-9-option-1">I. Normálna pozícia</label>
      <input type="radio" id="q-9-option-2" name="OSAS_answer_9" value="2">
      <label for="q-9-option-2">II. Retrognácia</label>
      <input type="radio" id="q-9-option-3" name="OSAS_answer_9" value="2">
      <label for="q-9-option-3">III. Prognácia</label>
    </div>
  </div>
{{!-- Od tialto neviem urcit --}}
  <div class="row_content" id="10">
    <div class="question-group">
      <p>2. Anomálie vzájomnej polohy zubných oblúkov:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-10-option-1" name="OSAS_answer_10" value="ÁNO">
      <label for="q-10-option-1">I. Otvorený hryz</label>
      <input type="radio" id="q-10-option-2" name="OSAS_answer_10" value="NIE">
      <label for="q-10-option-2">II. Prehryz</label>
      <input type="radio" id="q-10-option-3" name="OSAS_answer_10" value="NIE">
      <label for="q-10-option-3">III. Skrížený hryz</label>
    </div>
  </div>

  <div class="row_content" id="11">
    <div class="question-group">
      <p>3. Protrúzia:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-11-option-1" name="OSAS_answer_11" value="ÁNO">
      <label for="q-11-option-1">ÁNO</label>
      <input type="radio" id="q-11-option-2" name="OSAS_answer_11" value="NIE">
      <label for="q-11-option-2">NIE</label>
    </div>
  </div>
{{!-- Po tialto neviem urcit --}}
  <div class="row_content" id="12">
    <div class="question-group">
      <p>4. Úzke podnebie:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-12-option-1" name="OSAS_answer_12" value="2">
      <label for="q-12-option-1">ÁNO</label>
      <input type="radio" id="q-12-option-2" name="OSAS_answer_12" value="0">
      <label for="q-12-option-2">NIE</label>
    </div>
  </div>

  <div class="section">
    <h2>Fenotyp</h2>
  </div>

  <div class="row_content" id="13">
    <div class="radio-group">
      <input type="radio" id="q-13-option-1" name="OSAS_answer_13" value="2">
      <label for="q-13-option-1">Adenoid fenotyp</label>
      <input type="radio" id="q-13-option-2" name="OSAS_answer_13" value="0">
      <label for="q-13-option-2">Normálny fenotyp</label>
      <input type="radio" id="q-13-option-3" name="OSAS_answer_13" value="2">
      <label for="q-13-option-3">Fenotyp dospelého človeka</label>
    </div>
  </div>

  <div class="section">
    <h2>BROUILLETTE</h2>
  </div>

  <div class="row_content" id="14">
    <div class="question-group">
      <p>1. Apnoické pauzy:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-14-option-1" name="OSAS_answer_14" value="1">
      <label for="q-14-option-1">ÁNO</label>
      <input type="radio" id="q-14-option-2" name="OSAS_answer_14" value="0">
      <label for="q-14-option-2">NIE</label>
    </div>
  </div>

  <div class="row_content" id="15">
    <div class="question-group">
      <p>2. Chrápanie:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-15-option-1" name="OSAS_answer_15" value="0">
      <label for="q-15-option-1">NIKDY</label>
      <input type="radio" id="q-15-option-2" name="OSAS_answer_15" value="0">
      <label for="q-15-option-2">ZRIEDKAVO</label>
      <input type="radio" id="q-15-option-3" name="OSAS_answer_15" value="1">
      <label for="q-15-option-3">ČASTO</label>
      <input type="radio" id="q-15-option-4" name="OSAS_answer_15" value="1">
      <label for="q-15-option-4">VŽDY</label>
    </div>
  </div>

  <div class="row_content" id="16">
    <div class="question-group">
      <p>3. Časté prebúdzanie počas spánku:</p>
    </div>
    <div class="radio-group">
      <input type="radio" id="q-16-option-1" name="OSAS_answer_16" value="0">
      <label for="q-16-option-1">NIKDY</label>
      <input type="radio" id="q-16-option-2" name="OSAS_answer_16" value="1">
      <label for="q-16-option-2">ZRIEDKAVO</label>
      <input type="radio" id="q-16-option-3" name="OSAS_answer_16" value="2">
      <label for="q-16-option-3">ČASTO</label>
      <input type="radio" id="q-16-option-4" name="OSAS_answer_16" value="3">
      <label for="q-16-option-4">VŽDY</label>
    </div>
  </div>

  <div class="form_buttons">
    <p id="bad">Neodpovedali ste na všetky otázky v dotazníku.</p>
  </div>

  <div class="form_buttons">
    <button class="action_button_2" id="reset_button" type="reset">Vymazať</button>
    <button class="action_button_2" id="save_button" type="submit">Uložiť</button>
  </div>

</form>

<script>
  for (var rowNumber = 1; rowNumber <= 16; rowNumber++) {
    if (rowNumber % 2 == 0) {
      document.getElementById(rowNumber).style.backgroundColor = '#FFFFFF';
    } else {
      document.getElementById(rowNumber).style.backgroundColor = '#ACCEE5';
    }
  }

  let error = false;

  $('input').change(function () {
    error = false;
  });

  $.date = function (dateObject) {
    var d = new Date(dateObject);
    var day = d.getDate();
    var month = d.getMonth() + 1;
    var year = d.getFullYear();
    if (day < 10) {
      day = "0" + day;
    }
    if (month < 10) {
      month = "0" + month;
    }
    var date = day + "." + month + "." + year;
    return date;
  };

  $('#save_button').click(function (e) {
    e.preventDefault();
    checkInputs();
    if (error) {
      document.getElementById('bad').style.display = 'inline';
      return
    };
    let OsasFrom = [];
    $('input:checked').each(function () {
      var el = $(this);
      OsasFrom.push(el.val());
    });
    OsasFrom.push($.date(new Date()));
    console.log(OsasFrom);
    $.ajax({
      type: 'POST',
      url: '/vyber_dotaznika/syndrom_OSA?pacient=' + getUrlParameter('pacient'),
      data: JSON.stringify(OsasFrom),
      contentType: 'application/json',
      dataType: 'json',
      success: function (data, status) {
        window.location = '/zoznam_pacientov';
      },
      error: function (error) {
        console.log(error);
      }
    })
  });

  var getUrlParameter = function getUrlParameter(sParam) {
    var sPageURL = window.location.search.substring(1),
      sURLVariables = sPageURL.split('&'),
      sParameterName,
      i;

    for (i = 0; i < sURLVariables.length; i++) {
      sParameterName = sURLVariables[i].split('=');

      if (sParameterName[0] === sParam) {
        return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
      }
    }
  };

  function checkInputs() {

    var isChecked = false, ans, creator, radioBtnsAns2, radioBtnsAns3, radioBtnsAns4;
    radioBtnsAns2 = [1, 2, 3, 4, 5, 6, 11, 12, 14];
    radioBtnsAns3 = [9, 10, 13];
    radioBtnsAns4 = [7, 8, 15, 16];

    // check CREATOR
    for (var i = 0; i <= 2; i++) {
      isChecked = isChecked + document.getElementsByName('OSAS_creator')[i].checked;
    }
    if (isChecked === 0) {
      document.getElementById('0').style.backgroundColor = '#e4938a';
      error = true;
    } else {
      document.getElementById('0').style.backgroundColor = '#2ecc71';
    }

    // check RADIO INPUTS (4)
    for (ans = 0; ans < radioBtnsAns4.length; ans++) {
      isChecked = false;
      for (var i = 0; i <= 3; i++) {
        isChecked = isChecked + document.getElementsByName('OSAS_answer_' + radioBtnsAns4[ans])[i].checked;
      }
      if (isChecked === 0) {
        document.getElementById(radioBtnsAns4[ans]).style.backgroundColor = '#e4938a';
        error = true;
      } else {
        document.getElementById(radioBtnsAns4[ans]).style.backgroundColor = '#2ecc71';
      }
    }

    // check RADIO INPUTS (3)
    for (ans = 0; ans < radioBtnsAns3.length; ans++) {
      isChecked = false;
      for (var i = 0; i <= 2; i++) {
        isChecked = isChecked + document.getElementsByName('OSAS_answer_' + radioBtnsAns3[ans])[i].checked;
      }
      if (isChecked === 0) {
        document.getElementById(radioBtnsAns3[ans]).style.backgroundColor = '#e4938a';
        error = true;
      } else {
        document.getElementById(radioBtnsAns3[ans]).style.backgroundColor = '#2ecc71';
      }
    }

    // check RADIO INPUTS (2)
    for (ans = 0; ans < radioBtnsAns2.length; ans++) {
      isChecked = false;
      for (var i = 0; i <= 1; i++) {
        isChecked = isChecked + document.getElementsByName('OSAS_answer_' + radioBtnsAns2[ans])[i].checked;
      }
      if (isChecked === 0) {
        document.getElementById(radioBtnsAns2[ans]).style.backgroundColor = '#e4938a';
        error = true;
      } else {
        document.getElementById(radioBtnsAns2[ans]).style.backgroundColor = '#2ecc71';
      }
    }
  }
</script>